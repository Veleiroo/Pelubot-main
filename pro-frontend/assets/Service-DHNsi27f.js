import{j as e}from"./ui-vendor-DjtdC3iZ.js";import{u as C,c as E,r as h}from"./react-vendor-DWrzsp0o.js";import{a as p}from"./api-PPFfqhN_.js";import{u as _}from"./booking-CI0fwwsN.js";import{u as F}from"./index-CQSUpRmg.js";import{S as n}from"./skeleton-BQs0x_V-.js";import{c as $,e as A,u as K,B as L,d as P}from"./index-CX6e3e6v.js";import{C as Q,B as R}from"./crown-DCQ3R1ac.js";import{S as j}from"./scissors-d8NSnT0-.js";import{S as T}from"./sparkles-KJtnsgt-.js";import{B as g}from"./BookingLayout-DM7n9nHe.js";import{u as D}from"./useQuery-CdrMCFj5.js";import{f as v,b as O}from"./format-C7TXDquS.js";import{e as Z}from"./endOfMonth-BlNj78N-.js";import"./index-Dbmg-Ekv.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=$("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function U({title:o,subtitle:i,children:r}){return e.jsxs("section",{className:"mx-auto w-full max-w-3xl px-4 md:px-6",children:[e.jsxs("header",{className:"mb-6 text-center",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-semibold tracking-tight text-foreground",children:o}),i?e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:i}):null]}),e.jsx("div",{className:"space-y-6",children:r})]})}function Y({title:o,duration:i,price:r,icon:t,onSelect:f,attrsId:c,selected:d=!1,onPreview:m}){const l=()=>{m&&m()};return e.jsx("button",{type:"button",onClick:f,onMouseEnter:l,onFocus:l,onTouchStart:l,"aria-describedby":c,"aria-pressed":d,className:A("group h-full w-full rounded-2xl border bg-card p-6 text-left shadow-soft transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand focus-visible:ring-offset-2 focus-visible:ring-offset-background",d?"border-brand ring-1 ring-brand/40":"border-border hover:border-brand/60 hover:shadow-lg"),children:e.jsxs("div",{className:"flex h-full flex-col justify-between gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t?e.jsx("span",{className:"grid h-12 w-12 flex-none place-items-center rounded-xl bg-brand/10 text-brand",children:e.jsx(t,{className:"h-6 w-6","aria-hidden":"true"})}):null,e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold leading-6 text-foreground",children:o}),e.jsx("p",{className:"text-sm leading-6 text-muted-foreground",children:r})]})]}),e.jsxs("dl",{id:c,className:"grid gap-1 text-sm leading-6 text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-foreground",children:"Duración"}),e.jsx("span",{children:i})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-foreground",children:"Precio"}),e.jsx("span",{children:r})]})]})]}),e.jsx("span",{className:"inline-flex w-fit items-center rounded-xl bg-brand px-3 py-2 text-sm font-medium text-black transition group-hover:brightness-110",children:"Seleccionar servicio"})]})})}const le=()=>{const o=C(),i=E(),r=K(),t=h.useRef(new Set),{setService:f,serviceId:c}=_(s=>({setService:s.setService,serviceId:s.serviceId})),{data:d,isLoading:m,isError:l,error:a,refetch:y}=D({queryKey:["services"],queryFn:p.getServices,staleTime:5*60*1e3,retry:1});h.useEffect(()=>{a&&F.error(a.message)},[a]);const N=d??[],b=h.useCallback(s=>{if(!s||t.current.has(s))return;const u=s;t.current.add(u);const x=new Date,k=`${x.getFullYear()}-${x.getMonth()}`,q=v(O(x),"yyyy-MM-dd"),M=v(Z(x),"yyyy-MM-dd"),B=[r.prefetchQuery({queryKey:["professionals",s],queryFn:p.getProfessionals,staleTime:60*1e3,retry:1}),r.prefetchQuery({queryKey:["days-availability",s,k,"any",!1],queryFn:()=>p.getDaysAvailability({service_id:s,start:q,end:M,use_gcal:!1}),staleTime:30*1e3,retry:1})];Promise.all(B).catch(()=>{t.current.delete(u)})},[r]);if(m)return e.jsx(g,{title:"Selecciona un servicio",subtitle:"Elige el servicio que deseas reservar",children:e.jsx(U,{title:"Servicios disponibles",children:e.jsx("div",{role:"list",className:"grid grid-cols-1 gap-4 md:gap-6 auto-rows-fr sm:grid-cols-3",children:Array.from({length:6}).map((s,u)=>e.jsx("div",{className:"rounded-2xl border border-border bg-card p-6 shadow-soft",children:e.jsxs("div",{className:"flex h-full flex-col justify-between gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(n,{className:"h-12 w-12 rounded-xl"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(n,{className:"h-5 w-32"}),e.jsx(n,{className:"h-4 w-24"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"h-4 w-40"}),e.jsx(n,{className:"h-4 w-28"})]})]}),e.jsx(n,{className:"h-9 w-full rounded-xl"})]})},u))})})});if(l)return e.jsx(g,{title:"Selecciona un servicio",subtitle:"Elige el servicio que deseas reservar",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-red-500/10 border border-red-500/30 mb-4",children:e.jsx(z,{className:"h-6 w-6 text-red-400"})}),e.jsx("div",{className:"text-red-400 text-sm font-medium",children:(a==null?void 0:a.message)??"Error cargando servicios"}),e.jsx(L,{className:"mt-4",onClick:()=>y(),children:"Reintentar"})]})});const w=s=>{b(s.id),f(s.id,s.name),o(`/book/date?service=${encodeURIComponent(s.id)}`,{state:P(i)})},S={corte_cabello:j,corte_barba:T,arreglo_barba:R,corte_jubilado:Q};return e.jsx(g,{title:"Selecciona un servicio",subtitle:"Elige el servicio que deseas reservar",children:e.jsx("div",{className:"grid grid-cols-1 gap-4 md:gap-6 auto-rows-fr sm:grid-cols-3",children:N.map(s=>e.jsx(Y,{title:s.name,duration:`${s.duration_min} minutos`,price:`${s.price_eur} €`,icon:S[s.id]??j,onSelect:()=>w(s),attrsId:`svc-${s.id}`,selected:c===s.id,onPreview:()=>b(s.id)},s.id))})})};export{le as default};
