import{j as e}from"./ui-vendor-DjtdC3iZ.js";import{u as G,c as H,r as t}from"./react-vendor-DWrzsp0o.js";import{B as i,d as U}from"./index-CX6e3e6v.js";import{C as l,a as o,b as d,c as x}from"./card-SJHWFEUi.js";import{u as T}from"./booking-CI0fwwsN.js";import{a as h}from"./api-PPFfqhN_.js";import{S as q}from"./switch-tl2FQsIu.js";import{L as K}from"./label-JnwPont5.js";import"./index-Dbmg-Ekv.js";const ae=()=>{const r="http://127.0.0.1:8776",j=G(),v=H(),[f,m]=t.useState(null),[y,p]=t.useState(null),[S,N]=t.useState([]),[w,b]=t.useState([]),[C,D]=t.useState([]),[k,_]=t.useState([]),[c,B]=t.useState(""),[a,I]=t.useState(""),[n,O]=t.useState(""),[u,P]=t.useState(!1),{setService:E,setProfessional:J,setDate:Y,setSlot:z}=T(s=>s);t.useEffect(()=>{(async()=>{try{m(await fetch(r+"/health").then(s=>s.json()))}catch{}try{p(await fetch(r+"/ready").then(s=>s.json()))}catch{}try{N(await h.getServices())}catch{}try{b(await h.getProfessionals())}catch{}})()},[r]);const g=t.useMemo(()=>new Date().toISOString().slice(0,10),[]),A=async()=>{if(!a)return;const s=g.slice(0,7)+"-01",R=new Date(new Date(s).getFullYear(),new Date(s).getMonth()+1,0).toISOString().slice(0,10),F=await h.getDaysAvailability({service_id:a,start:s,end:R,professional_id:n||void 0,use_gcal:u});D(F.available_days)},M=async()=>{if(!a||!c)return;const s=await h.getSlots({service_id:a,date:c,professional_id:n||void 0,use_gcal:u});_(s.slots)},L=s=>{E(a),J(n||null),Y(c),z(s),j("/book/confirm?service="+encodeURIComponent(a),{state:U(v)})};return e.jsxs("div",{className:"mx-auto max-w-5xl p-6 space-y-6",children:[e.jsxs(l,{className:"border-neutral-800 bg-neutral-900 text-white",children:[e.jsx(o,{children:e.jsx(d,{children:"Configuración de Debug"})}),e.jsxs(x,{className:"text-sm text-neutral-300 space-y-1",children:[e.jsxs("div",{children:["BASE: ",r]}),e.jsxs("div",{children:["Autenticación: gestionada desde servidor (reservas públicas ","desactivadas",")"]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs(l,{className:"border-neutral-800 bg-neutral-900 text-white",children:[e.jsx(o,{children:e.jsx(d,{children:"/health & /ready"})}),e.jsxs(x,{children:[e.jsxs("div",{className:"text-xs whitespace-pre-wrap",children:["health: ",JSON.stringify(f)]}),e.jsxs("div",{className:"text-xs whitespace-pre-wrap",children:["ready: ",JSON.stringify(y)]}),e.jsxs("div",{className:"mt-2 space-x-2",children:[e.jsx(i,{size:"sm",onClick:async()=>m(await fetch(r+"/health").then(s=>s.json())),children:"Ping /health"}),e.jsx(i,{size:"sm",onClick:async()=>p(await fetch(r+"/ready").then(s=>s.json())),children:"Ping /ready"})]})]})]}),e.jsxs(l,{className:"border-neutral-800 bg-neutral-900 text-white",children:[e.jsx(o,{children:e.jsx(d,{children:"Catálogos"})}),e.jsxs(x,{children:[e.jsxs("div",{className:"text-xs whitespace-pre-wrap",children:["services: ",JSON.stringify(S)]}),e.jsxs("div",{className:"text-xs whitespace-pre-wrap",children:["professionals: ",JSON.stringify(w)]})]})]})]}),e.jsxs(l,{className:"border-neutral-800 bg-neutral-900 text-white",children:[e.jsx(o,{children:e.jsx(d,{children:"Disponibilidad"})}),e.jsxs(x,{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 items-end",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-neutral-400",children:"service_id"}),e.jsx("input",{className:"bg-neutral-800 border border-neutral-700 rounded px-2 py-1 text-sm",value:a,onChange:s=>I(s.target.value),placeholder:"corte"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-neutral-400",children:"professional_id"}),e.jsx("input",{className:"bg-neutral-800 border border-neutral-700 rounded px-2 py-1 text-sm",value:n,onChange:s=>O(s.target.value),placeholder:"(opcional)"})]}),e.jsxs("div",{className:"flex items-center gap-2 h-[32px]",children:[e.jsx(q,{id:"dbg-use-gcal",checked:u,onCheckedChange:P}),e.jsx(K,{htmlFor:"dbg-use-gcal",className:"text-xs text-neutral-300",children:"use_gcal"})]}),e.jsx(i,{size:"sm",onClick:A,children:"/days"})]}),e.jsxs("div",{className:"text-xs whitespace-pre-wrap",children:["days: ",JSON.stringify(C)]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-end mt-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-neutral-400",children:"date (YYYY-MM-DD)"}),e.jsx("input",{className:"bg-neutral-800 border border-neutral-700 rounded px-2 py-1 text-sm",value:c,onChange:s=>B(s.target.value),placeholder:g})]}),e.jsx(i,{size:"sm",onClick:M,children:"/slots"})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 mt-2",children:k.map(s=>e.jsx(i,{variant:"secondary",onClick:()=>L(s),children:s.slice(11,16)},s))})]})]})]})};export{ae as default};
